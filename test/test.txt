---

# ğŸ“˜ **Sitemap Visibility Control â€“ Using SVT Config Table / Reference Table / Feature Flag Table**

### *(Modern App Designer â€“ Replacement for â€œVisible to Rolesâ€)*

## **1. Background**

In the new **Modern App Designer**, Microsoft has removed the classic **â€œVisible to Rolesâ€** option.
Subarea visibility can no longer be controlled directly by assigning security roles.

Instead, Microsoft now requires visibility to be controlled using:

* **Table Privileges (Recommended)**
* **Miscellaneous Privileges** (rarely used)

For the Welsh Revaluation tools (SVT, SBL, Batch Management, DLM screens), we must use a consistent, supportable pattern to conditionally hide or show **Custom Pages** and **subareas**.

---

# ğŸ¯ **2. Design Decision**

We will use **Dataverse table-based privilege visibility** to control sitemap access.
This will allow us to hide specific subareas (e.g., *SVT View*, *SVT Dashboard*, *Batch Review*, *Config Pages*) during:

* POC phase
* Internal testing
* Feature rollout
* Temporary disabling (e.g., hotfix / maintenance)

We will implement visibility using **one of the following tables:**

### **Option A â€“ SVT Config Table** *(recommended if already present)*

Use an existing SVT configuration table that only specific roles (e.g., Dev, Test, SVT Admin) have permission for.

### **Option B â€“ Reference Table (SVT Ref Table / Admin Table)**

Use an existing reference table that is only accessible to SVT/DLM internal teams.

### **Option C â€“ Dedicated Feature Flag Table** *(recommended for long-term toggles)*

Create a simple table: **svt_FeatureFlag**
Fields:

* FlagName (Text)
* IsEnabled (Yes/No)
* Description (Text)

Assign **Read** privilege only to specific roles.

---

# ğŸ›  **3. How Sitemap Visibility Works**

A subarea can be configured to be visible **only if the user has a specific privilege** on a table.

In the Modern App Designer:

1. Select the **Subarea**
2. Go to **Advanced Settings â†’ Privileges â†’ Add Table Privilege**
3. Select:

   * **SVT Config Table**, or
   * **SVT Reference Table**, or
   * **FeatureFlag table**
4. Choose **Read** privilege
5. Save + Publish

### **Effect**

* Only users who *have Read permission* for the selected table will see the subarea.
* All other users will **not** see it in the sitemap.

This effectively replaces â€œVisible to Rolesâ€.

---

# ğŸ”’ **4. Security Model**

### **Roles That Should Have Access**

* SVT Admin
* SVT Caseworker (if required)
* Test roles during development
* DevOps/Technical teams (optional)

### **Roles That Should NOT Have Access**

* General end users
* BAU Dynamics users not part of SVT rollout
* Any role outside the SVT testing group during development

Visibility is automatically determined by whether their role includes **Read** access to the selected table.

---

# âš™ï¸ **5. Example Implementation**

### Scenario

We want to hide **SVT Dashboard** and **SVT View** pages until testing is complete.

### Steps

1. Use the table: **svt_FeatureFlag**
2. Give Read access only to:

   * `SVT Admin`
   * `SVT Dev/Test`
3. In the sitemap:

   * Edit **SVT Dashboard** subarea
   * Add Table Privilege â†’ Select **svt_FeatureFlag**
   * Choose privilege: **Read**
4. Publish the app.

### Result

* Only Admin, Dev, and Test users see these pages.
* All others will not see the subarea.
* When ready to release â†’ simply add Read permission to additional security roles.

---

# ğŸš¦ **6. Alternative Temporary Hide: Disable Subarea**

If we want to hide the page from *everyone* during a POC:

1. Open the Subarea
2. Set **Enable = OFF**
3. Publish

This disables the node completely until re-enabled.

---

# ğŸ“Œ **7. Why We Chose Table-Based Visibility**

| Reason                                            | Benefit                                                           |
| ------------------------------------------------- | ----------------------------------------------------------------- |
| Modern App Designer removed role-based visibility | Table privileges are the only supported replacement               |
| Works well with Dev â†’ Test â†’ Prod                 | We can control visibility via security roles                      |
| Feature-flag ready                                | Adding/removing access to the table instantly controls visibility |
| Keeps SVT screens hidden during early POC         | No accidental exposure to live users                              |
| ALM friendly                                      | Solution export/import preserves privilege settings               |

This method is used across multiple HMRC/VOA projects for secure phased rollouts.

---

# ğŸ“š **8. Naming Convention (Recommended)**

If creating a new Feature Flag table:

| Column            | Purpose                                                   |
| ----------------- | --------------------------------------------------------- |
| `svt_name`        | Unique flag identifier (e.g., `ShowSVTDashboard`)         |
| `svt_IsEnabled`   | Whether the feature is active                             |
| `svt_Description` | Notes (e.g., â€œVisible only to SVT Admin until Release 1â€) |

Even though the `IsEnabled` field is not read by the sitemap, it documents the state and can be used for future UI logic.

---

# ğŸ **9. Summary**

âœ” Sitemap role visibility is no longer supported in Modern Designer
âœ” Must use **table privileges**
âœ” Use **SVT Config / Ref Table / FeatureFlag Table**
âœ” Grant **Read** access only to selected roles
âœ” Subarea hides automatically for all others
âœ” Fully supports SVT/SBL/DLM phased rollout
